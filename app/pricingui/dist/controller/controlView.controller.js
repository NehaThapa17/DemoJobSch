sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageBox","sap/ui/model/json/JSONModel","sap/ui/core/Fragment","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/core/BusyIndicator","sap/m/MessageToast","sap/m/Token","marathonpetroleum/hsc/pricingui/utils/formatter","marathonpetroleum/hsc/pricingui/utils/constants","sap/m/SearchField"],function(e,t,i,a,r,o,n,s,d,l,u,c){"use strict";return e.extend("marathonpetroleum.hsc.pricingui.controller.controlView",{formatter:l,onInit:function(){this.oBundle=this.getOwnerComponent().getModel("i18n").getResourceBundle();this.oDataModelT=this.getOwnerComponent().getModel();n.show();var e=new i;var t=[];e.setData(t);this.getView().setModel(e,"oModel");this.getOwnerComponent().setModel(e,"oModel");this.getView().byId("idMultiInputTerminal").setModel(e,"oModel");var a=sap.ui.core.UIComponent.getRouterFor(this);a.getRoute("RoutecontrolView").attachPatternMatched(this.onRouteControl,this);this.getTerminalDetails();this.getProductDetails();this.getF4Customer();this.getF4Terminal();this.getF4Product();this.getCCEmails()},getJSTime:function(){n.show();var e=this;this.oDataModelT.callFunction("/getJobDetails",{method:u.httpGet,success:function(t){n.hide();var i=JSON.parse(t.getJobDetails);if(i.DISPLAY!==undefined){var a=new Date,r=i.DISPLAY.indexOf(u.DIV),o=i.DISPLAY.substring(u.INTZERO,r),s=i.DISPLAY.substring(r+u.INTONE);a.setHours(o);a.setMinutes(s);var d=new Date(a.getFullYear(),u.INTZERO,u.INTONE);var l=new Date(a.getFullYear(),u.INTSIX,u.INTONE);var c=Math.max(d.getTimezoneOffset(),l.getTimezoneOffset());if(a.getTimezoneOffset()<c){a=new Date(a.getTime()-u.INTONE*u.INTSIXTY*u.INTSIXTY*u.INTTHOUS*u.INTFIVE)}else{a=new Date(a.getTime()-u.INTONE*u.INTSIXTY*u.INTSIXTY*u.INTTHOUS*u.INTSIX)}var g=a.toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:true});e.getView().byId("idTextDailyST").setText(g);e.getView().byId("idTimePickerInput").setValue(g);e.getView().byId("idSwitchInput").setState(true);e.getView().byId("idInfoLabel").setColorScheme(u.INTSEVEN);e.getView().byId("idInfoLabel").setText("Active");e.getView().byId("idTimePickerInput").setEnabled(false)}else{e.getView().byId("idTextDailyST").setText(u.SPACE);e.getView().byId("idTimePickerInput").setValue(u.SPACE);e.getView().byId("idSwitchInput").setState(false);e.getView().byId("idTimePickerInput").setEnabled(true);e.getView().byId("idInfoLabel").setText("InActive");e.getView().byId("idInfoLabel").setColorScheme(u.INTONE)}if(i.ONDEMAND!==undefined){var a=new Date(i.ONDEMAND);var d=new Date(a.getFullYear(),u.INTZERO,u.INTONE);var l=new Date(a.getFullYear(),u.INTSIX,u.INTONE);var c=Math.max(d.getTimezoneOffset(),l.getTimezoneOffset());if(a.getTimezoneOffset()<c){a=new Date(a.getTime()-u.INTONE*u.INTSIXTY*u.INTSIXTY*u.INTTHOUS*u.INTFIVE)}else{a=new Date(a.getTime()-u.INTONE*u.INTSIXTY*u.INTSIXTY*u.INTTHOUS*u.INTSIX)}var g=a.toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:true});var h=a.toDateString(),m=h.slice(4)+u.SPACE+g;e.getView().byId("idTextOnDemandST").setText(m);e.getView().byId("idDatePickerOnDemand").setValue(m);e.getView().getModel("oModel").setProperty("/dateValue",m)}else{e.getView().byId("idTextOnDemandST").setText(u.SPACE);e.getView().getModel("oModel").setProperty("/dateValue",u.SPACE)}if(i.sActive!=="Completed"&&i.SUSPENDTo!==undefined&&i.SUSPENDFrom!==undefined){var T=new Date(i.SUSPENDTo);var I=new Date(i.SUSPENDFrom);var p=new Date(I.getFullYear(),u.INTZERO,u.INTONE);var f=new Date(I.getFullYear(),u.INTSIX,u.INTONE);var S=Math.max(p.getTimezoneOffset(),f.getTimezoneOffset());if(I.getTimezoneOffset()<S){I=new Date(I.getTime()-u.INTONE*u.INTSIXTY*u.INTSIXTY*u.INTTHOUS*u.INTFIVE)}else{I=new Date(I.getTime()-u.INTONE*u.INTSIXTY*u.INTSIXTY*u.INTTHOUS*u.INTSIX)}var g=I.toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:true});var h=I.toDateString(),P=h.slice(4)+u.SPACE+g;var V=new Date(T.getFullYear(),u.INTZERO,u.INTONE);var b=new Date(T.getFullYear(),u.INTSIX,u.INTONE);var w=Math.max(V.getTimezoneOffset(),b.getTimezoneOffset());if(T.getTimezoneOffset()<w){T=new Date(T.getTime()-u.INTONE*u.INTSIXTY*u.INTSIXTY*u.INTTHOUS*u.INTFIVE)}else{T=new Date(T.getTime()-u.INTONE*u.INTSIXTY*u.INTSIXTY*u.INTTHOUS*u.INTSIX)}var D=T.toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:true});var N=T.toDateString(),v=N.slice(4)+u.SPACE+D;if(i.sActive===true){e.getView().byId("idInfoLabel").setText("Suspended");e.getView().byId("idInfoLabel").setColorScheme(2)}e.getView().byId("idObjStatusS2").setText(v);e.getView().byId("idObjStatusS1").setText(P);e.getView().getModel("oModel").setProperty("/dateValueF",P);e.getView().getModel("oModel").setProperty("/dateValueT",v);e.getView().byId("idDatePickerSuspend").setValue(P);e.getView().byId("idDatePicker2Suspend").setValue(v)}else{e.getView().byId("idObjStatusS2").setText(u.SPACE);e.getView().byId("idObjStatusS1").setText(u.SPACE);e.getView().getModel("oModel").setProperty("/dateValueF",u.SPACE);e.getView().getModel("oModel").setProperty("/dateValueT",u.SPACE)}},error:function(i){n.hide();t.error(e.oBundle.getText("techError"),{details:i})}})},onRouteControl:function(){this.getCustomerDetails()},getCCEmails:function(){var e=this;this.oDataModelT.callFunction("/getOnCCEmail",{method:u.httpGet,success:function(t){var i=t.getOnCCEmail.data,a;if(i!=undefined){if(i.length!=u.INTZERO){for(var r=u.INTZERO;r<i.length;r++){switch(i[r].Key){case u.emailCC:a=i[r].Value.split(u.spliter);break;case u.checkD:break}}}}e.getView().getModel("oModel").setProperty("/emailsCC",a);n.hide()},error:function(i){n.hide();t.error(e.oBundle.getText("techError"),{details:i})}})},getTerminalDetails:function(){var e=this;this.oDataModelT.callFunction("/getTerminalDetails",{method:u.httpGet,success:function(t){if(t.getTerminalDetails.data){var i=t.getTerminalDetails.data,a=[];for(var r=0;r<i.length;r++){if(i[r].OnDemandJob===true){var o=i[r].Terminal;a.push(o)}}e.getView().byId("idMultiInputTerminal").setSelectedKeys(a);e.getView().getModel("oModel").setProperty("/TerminalData",t.getTerminalDetails.data);e.getView().byId("idTitleTerminal").setText(e.oBundle.getText("comTerText",[t.getTerminalDetails.data.length]))}n.hide()},error:function(i){n.hide();t.error(e.oBundle.getText("techError"),{details:i})}})},getProductDetails:function(){var e=this;this.oDataModelT.callFunction("/getOnPremProductDetails",{method:u.httpGet,success:function(t){if(t.getOnPremProductDetails.data){e.getView().getModel("oModel").setProperty("/ProductData",t.getOnPremProductDetails.data);e.getView().byId("idTitleProduct").setText(e.oBundle.getText("comProText",[t.getOnPremProductDetails.data.length]))}n.hide()},error:function(i){n.hide();t.error(e.oBundle.getText("techError"),{details:i})}})},getCustomerDetails:function(){var e=this;this.oDataModelT.callFunction("/getCustomerDetails",{method:u.httpGet,success:function(t){var i=[],a=[];var r=t.getCustomerDetails.data;if(r){e.getView().byId("idTitleCustomer").setText(e.oBundle.getText("comCusText",[t.getCustomerDetails.data.length]));for(var o=u.INTZERO;o<r.length;o++){var s=r[o].EmailTo.split(u.spliter),d=[];for(var l=u.INTZERO;l<s.length;l++){var c={},g="",h="",m="",T="";c.email=s[l];d.push(c)}if(r[o].TerminalList.results.length!=u.INTZERO){g=r[o].TerminalList.results[u.INTZERO].Terminal;h=r[o].TerminalList.results[u.INTZERO].TerminalName}if(r[o].ProductList.results.length!=u.INTZERO){m=r[o].ProductList.results[u.INTZERO].Product;T=r[o].ProductList.results[u.INTZERO].ProductName}if(r[o].OnDemandJob===true){var I=new sap.m.Token({key:r[o].Customer+"/"+r[o].ShipTo,text:r[o].ShipToName+"("+r[o].Customer+"/"+r[o].ShipTo+")"});a.push(I)}var p={};p={CountEmail:r[o].CountEmail,CountProduct:r[o].CountProduct,CountTerminal:r[o].CountTerminal,CountShipTo:r[o].CountShipTo,Customer:r[o].Customer,CustomerName:r[o].CustomerName,DailyJob:r[o].DailyJob,EmailTo:r[o].EmailTo,OnDemandJob:r[o].OnDemandJob,ProductList:r[o].ProductList,TerminalList:r[o].TerminalList,ProductFirst:m,ProdNameFirst:T,TerminalFirst:g,TerNameFirst:h,ShipTo:r[o].ShipTo,ShipToName:r[o].ShipToName,EmailArray:d,VHKey:r[o].Customer+"/"+r[o].ShipTo};i.push(p)}e.getView().byId("idMultiInputCustomer").setTokens(a);e.getView().getModel("oModel").setProperty("/CustomerData",i);n.hide()}},error:function(i){n.hide();t.error(e.oBundle.getText("techError"),{details:i})}})},getF4Customer:function(){var e=this;this.oDataModelT.callFunction("/getOnPremCustomerF4",{method:u.httpGet,success:function(t){e.getView().getModel("oModel").setProperty("/CustValHelp",t.getOnPremCustomerF4.data);n.hide()},error:function(i){n.hide();t.error(e.oBundle.getText("techError"),{details:i})}})},getF4Terminal:function(){var e=this;this.oDataModelT.callFunction("/getOnPremTerminalF4",{method:u.httpGet,success:function(t){e.getView().getModel("oModel").setProperty("/TerminalValHelp",t.getOnPremTerminalF4.data);n.hide()},error:function(i){n.hide();t.error(e.oBundle.getText("techError"),{details:i})}})},getF4Product:function(){var e=this;this.oDataModelT.callFunction("/getOnPremProductF4",{method:u.httpGet,success:function(t){e.getView().getModel("oModel").setProperty("/ProductValHelp",t.getOnPremProductF4.data);n.hide()},error:function(i){n.hide();t.error(e.oBundle.getText("techError"),{details:i})}})},onDeleteCustomer:function(){var e=this.getView().byId("idProductsTable"),i=this,a=e.getSelectedContextPaths()[0];var r=e.indexOfItem(e.getSelectedItem());var o=this.getView().getModel("oModel").getProperty(a);if(r!==u.INTNEGONE){var d=o;t.confirm(i.oBundle.getText("customerDeleted",[d.Customer,d.CustomerName,d.ShipTo,d.ShipToName]),{onClose:function(e){if(e===u.actionOK){n.show();i.oDataModelT.callFunction("/deleteCustomer",{method:u.httpPost,urlParameters:{customer:d.Customer,shipTo:d.ShipTo},success:function(e){n.hide();if(e.deleteCustomer.data.message!==undefined){t.error(e.deleteCustomer.data.message)}else{s.show(i.oBundle.getText("delSucc"));i.getCustomerDetails()}},error:function(e){n.hide();var i=e.message;t.error(i,{details:e})}})}}})}else{t.error(i.oBundle.getText("delCheck"))}},onDeleteCustomerPopout:function(){var e=this.getView().byId("idTablePopout"),i=this,a=e.getSelectedContextPaths()[0];var r=e.indexOfItem(e.getSelectedItem());var o=this.getView().getModel("oModel").getProperty(a);if(r!==u.INTNEGONE){var d=o;t.confirm(i.oBundle.getText("customerDeleted",[d.Customer,d.CustomerName,d.ShipTo,d.ShipToName]),{onClose:function(e){if(e===u.actionOK){n.show();i.oDataModelT.callFunction("/deleteCustomer",{method:u.httpPost,urlParameters:{customer:d.Customer,shipTo:d.ShipTo},success:function(e){n.hide();if(e.deleteCustomer.data.message!==undefined){t.error(e.deleteCustomer.data.message)}else{s.show(i.oBundle.getText("delSucc"));i.getCustomerDetails()}},error:function(e){n.hide();var i=e.message;t.error(i,{details:e})}})}}})}else{t.error(i.oBundle.getText("delCheck"))}},onSwtichChange:function(e){n.show();var t=e.getSource().getState(),i=this.getView().byId("idTimePickerInput").getValue();this.getJSStatus(t,i)},getJSStatus:function(e,i){var a=this;this.oDataModelT.callFunction("/getJobDetails",{method:u.httpGet,success:function(r){var o=JSON.parse(r.getJobDetails);if(o.sActive===true){n.hide();if(e===false){a.getView().byId("idSwitchInput").setState(true)}else{a.getView().byId("idSwitchInput").setState(false)}a.getView().byId("idInfoLabel").setText("Suspended");a.getView().byId("idInfoLabel").setColorScheme(2);t.error(a.oBundle.getText("susCheck"))}else{n.hide();a.executeSchDaily(e,i)}},error:function(e){n.hide();t.error(a.oBundle.getText("techError"),{details:e})}})},executeSchDaily:function(e,i){var a=this;if(e===false){this.getView().byId("idTimePickerInput").setEnabled(true);this.getView().byId("idInfoLabel").setText("InActive");this.getView().byId("idInfoLabel").setColorScheme(u.INTONE);this.oDataModelT.callFunction("/deleteSchedule",{method:u.httpGet,urlParameters:{desc:u.daily},success:function(e){n.hide()},error:function(e){n.hide();t.error(a.oBundle.getText("techError"),{details:e})}})}else{if(i!==""&&i!==u.SPACE&&i!==undefined){n.show();var r=new Date(this.getView().byId("idTimePickerInput").getDateValue()),o=r.getHours(),s=(r.getMinutes()<u.INTTEN?u.ZERO:"")+r.getMinutes(),d=new Date;d.setHours(o);d.setMinutes(s);var l=new Date(d.getFullYear(),u.INTZERO,u.INTONE);var c=new Date(d.getFullYear(),u.INTSIX,u.INTONE);var g=Math.max(l.getTimezoneOffset(),c.getTimezoneOffset());if(d.getTimezoneOffset()<g){d=new Date(d.getTime()+u.INTONE*u.INTSIXTY*u.INTSIXTY*u.INTTHOUS*u.INTFIVE)}else{d=new Date(d.getTime()+u.INTONE*u.INTSIXTY*u.INTSIXTY*u.INTTHOUS*u.INTSIX)}var h=(d.getMinutes()<u.INTTEN?u.ZERO:"")+d.getMinutes();var m=d.getHours()+u.DIV+h;this.getView().byId("idTimePickerInput").setEnabled(false);this.getView().byId("idInfoLabel").setColorScheme(u.INTSEVEN);this.getView().byId("idInfoLabel").setText("Active");this.getView().byId("idTextDailyST").setText(i);this.oDataModelT.callFunction("/createSchedule",{method:u.httpGet,urlParameters:{time:m,desc:u.daily},success:function(e){n.hide();t.success(a.oBundle.getText("succJSDaily"))},error:function(e){n.hide();t.error(a.oBundle.getText("techError"),{details:e})}})}else{a.getView().byId("idSwitchInput").setState(false);t.error(a.oBundle.getText("manTime"))}}},onValueHelpRequested:function(){this._oBasicSearchField=new c;this.oColModel=new i;var e={cols:[{label:this.oBundle.getText("customerID"),template:"Customer",iskey:true},{label:"Customer Name",template:"CustomerName"},{label:"Ship-To",template:"ShipTo",iskey:true},{label:"Ship-To Name",template:"ShipToName"}]};this.oColModel.setData(e);this._oValueHelpDialogCust=sap.ui.xmlfragment(u.fragmentCusVH,this);this.getView().addDependent(this._oValueHelpDialogCust);var t=this._oValueHelpDialogCust.getFilterBar();t.setFilterBarExpanded(false);t.setBasicSearch(this._oBasicSearchField);this._oBasicSearchField.attachSearch(function(){t.search()});this.valueHelpModel=this.getView().getModel("oModel");this._oValueHelpDialogCust.getTableAsync().then(function(t){t.setModel(this.valueHelpModel);t.setModel(this.oColModel,"columns");if(t.bindRows){t.bindAggregation("rows","/CustomerData")}if(t.bindItems){t.bindAggregation("items","/CustomerData",function(){return new ColumnListItem({cells:e.map(function(e){return new Label({text:"{"+e.template+"}"})})})})}this._oValueHelpDialogCust.update()}.bind(this));this._oValueHelpDialogCust.setTokens(this.getView().byId("idMultiInputCustomer").getTokens());this._oValueHelpDialogCust.open()},onValueHelpOkPress:function(e){var t=e.getParameter("tokens");this.getView().byId("idMultiInputCustomer").setTokens(t);this._oValueHelpDialogCust.close()},onValueHelpCancelPress:function(){this._oValueHelpDialogCust.close()},onValueHelpAfterClose:function(){this._oValueHelpDialogCust.destroy()},handleTableSelectDialogPress:function(){var e=this.getView();if(!this.byId("custTable")){a.load({id:e.getId(),name:u.fragmentCusTablePopout,controller:this}).then(function(t){e.addDependent(t);t.open()})}else{this.byId("custTable").open()}},handleProductTableSelectDialogPress:function(){var e=this.getView();if(!this.byId("prodTable")){a.load({id:e.getId(),name:u.fragmentProdTablePopout,controller:this}).then(function(t){e.addDependent(t);t.open()})}else{this.byId("prodTable").open()}},handleTerminalTableSelectDialogPress:function(){var e=this.getView();if(!this.byId("terTable")){a.load({id:e.getId(),name:u.fragmentTerTablePopout,controller:this}).then(function(t){e.addDependent(t);t.open()})}else{this.byId("terTable").open()}},handleEmailPopoverPress:function(e){var t=e.getSource(),r=this.getView(),o=e.getSource().getParent().getParent().getBindingContextPath(),n=this.getView().getModel("oModel").getProperty(o),s=new i;s.setData(n.EmailArray);if(!this._pPopoverEmail){this._pPopoverEmail=a.load({id:r.getId(),name:u.fragmentEmailPopover,controller:this}).then(function(e){r.addDependent(e);return e})}this._pPopoverEmail.then(function(e){e.openBy(t);e.setModel(s)})},handlePopoverPress:function(e){var t=e.getSource(),r=this.getView(),o=e.getSource().getParent().getParent().getParent().getBindingContextPath(),n=this.getView().getModel("oModel").getProperty(o),s=new i;s.setData(n.ProductList);if(!this._pPopover){this._pPopover=a.load({id:r.getId(),name:u.fragmentProdPopover,controller:this}).then(function(e){r.addDependent(e);return e})}this._pPopover.then(function(e){e.openBy(t);e.setModel(s)})},handleTerPopoverPress:function(e){var t=e.getSource(),r=this.getView(),o=e.getSource().getParent().getParent().getParent().getBindingContextPath(),n=this.getView().getModel("oModel").getProperty(o),s=new i;s.setData(n.TerminalList);if(!this._tPopover){this._tPopover=a.load({id:r.getId(),name:u.fragmentTerPopover,controller:this}).then(function(e){r.addDependent(e);return e})}this._tPopover.then(function(e){e.openBy(t);e.setModel(s)})},handleTerminalSelectDialogPress:function(){var e=this.getView();if(!this.byId("addTerminal")){a.load({id:e.getId(),name:u.fragmentAddTerminal,controller:this}).then(function(t){e.addDependent(t);t.open();t.setTitle("Add Terminal")})}else{this.byId("addTerminal").open();oDialog.setTitle("Add Terminal")}},onTerminalClose:function(){this.byId("addTerminal").close();this.byId("addTerminal").destroy()},handleEditTerminalSelectDialogPress:function(){var e=this.getView().byId("idTableTerminal"),i=this;var r=this.getView().getModel("oModel").getProperty("/TerminalData");var o=e.indexOfItem(e.getSelectedItem());if(o!==u.INTNEGONE){var n=r[o];var s=this.getView();if(!this.byId("addTerminal")){a.load({id:s.getId(),name:u.fragmentAddTerminal,controller:this}).then(function(e){s.addDependent(e);e.open();e.setTitle(i.oBundle.getText("editTerminal"));var t=sap.ui.core.Fragment.byId(s.getId(),"idInputTerminalID");t.setEnabled(false);sap.ui.core.Fragment.byId(s.getId(),"idInputTerminalID").setValue(n.Terminal);sap.ui.core.Fragment.byId(s.getId(),"idInputTerminalName").setValue(n.TerminalName);sap.ui.core.Fragment.byId(s.getId(),"idCheckBoxDaily").setSelected(n.DailyJob);sap.ui.core.Fragment.byId(s.getId(),"idCheckBoxOnDemand").setSelected(n.OnDemandJob)})}}else{t.error(i.oBundle.getText("selectTerminal"))}},handleEditTerminalPopout:function(){var e=this.getView().byId("idTerTablePopout"),i=this;var r=this.getView().getModel("oModel").getProperty("/TerminalData");var o=e.indexOfItem(e.getSelectedItem());if(o!==u.INTNEGONE){var n=r[o];var s=this.getView();if(!this.byId("addTerminal")){a.load({id:s.getId(),name:u.fragmentAddTerminal,controller:this}).then(function(e){s.addDependent(e);e.open();e.setTitle(i.oBundle.getText("editTerminal"));var t=sap.ui.core.Fragment.byId(s.getId(),"idInputTerminalID");t.setEnabled(false);sap.ui.core.Fragment.byId(s.getId(),"idInputTerminalID").setValue(n.Terminal);sap.ui.core.Fragment.byId(s.getId(),"idInputTerminalName").setValue(n.TerminalName);sap.ui.core.Fragment.byId(s.getId(),"idCheckBoxDaily").setSelected(n.DailyJob);sap.ui.core.Fragment.byId(s.getId(),"idCheckBoxOnDemand").setSelected(n.OnDemandJob)})}}else{t.error(i.oBundle.getText("selectTerminal"))}},handleProductSelectDialogPress:function(){var e=this.getView(),t=this;if(!this.byId("addProduct")){a.load({id:e.getId(),name:u.fragmentAddProd,controller:this}).then(function(i){e.addDependent(i);i.open();i.setTitle(t.oBundle.getText("addProduct"))})}else{this.byId("addProduct").open();oDialog.setTitle(t.oBundle.getText("addProduct"))}},handleEditProductSelectDialogPress:function(){var e=this.getView().byId("producttbl"),i=this;var r=this.getView().getModel("oModel").getProperty("/ProductData");var o=e.indexOfItem(e.getSelectedItem());if(o!==u.INTNEGONE){var n=r[o];var s=this.getView();if(!this.byId("addProduct")){a.load({id:s.getId(),name:u.fragmentAddProd,controller:this}).then(function(e){s.addDependent(e);e.open();e.setTitle(i.oBundle.getText("editProduct"));var t=sap.ui.core.Fragment.byId(s.getId(),"idInputProductID");var a=sap.ui.core.Fragment.byId(s.getId(),"idInputProductName");t.setValue(n.Product);t.setEnabled(false);a.setValue(n.ProductName)})}else{this.byId("addProduct").open();oDialog.setTitle(i.oBundle.getText("editProduct"))}}else{t.error(this.oBundle.getText("selectProduct"))}},handleEditProductPopout:function(){var e=this.getView().byId("idProdTablePopout"),i=this;var r=this.getView().getModel("oModel").getProperty("/ProductData");var o=e.indexOfItem(e.getSelectedItem());if(o!==u.INTNEGONE){var n=r[o];var s=this.getView();if(!this.byId("addProduct")){a.load({id:s.getId(),name:u.fragmentAddProd,controller:this}).then(function(e){s.addDependent(e);e.open();e.setTitle(i.oBundle.getText("editProduct"));var t=sap.ui.core.Fragment.byId(s.getId(),"idInputProductID");var a=sap.ui.core.Fragment.byId(s.getId(),"idInputProductName");t.setValue(n.Product);t.setEnabled(false);a.setValue(n.ProductName)})}else{this.byId("addProduct").open();oDialog.setTitle(i.oBundle.getText("editProduct"))}}else{t.error(this.oBundle.getText("selectProduct"))}},onProductClose:function(){this.byId("addProduct").close();this.byId("addProduct").destroy()},onClose:function(){this.byId("custTable").close()},onCloseProd:function(){this.byId("prodTable").close()},onCloseTer:function(){this.byId("terTable").close()},onCreateCustomer:function(){var e=sap.ui.core.UIComponent.getRouterFor(this);e.navTo("RoutecreateView")},onSearchCustomerPop:function(e){var t=[],i=[];var a=e.getSource().getValue();if(a&&a.length>u.INTZERO){t.push(new r({filters:[new r({path:u.pathCus,operator:o.Contains,value1:a}),new r({path:u.pathCName,operator:o.Contains,value1:a}),new r({path:u.pathSH,operator:o.Contains,value1:a}),new r({path:u.pathSHName,operator:o.Contains,value1:a})],and:false}));i.push(new r({filters:t,and:true}))}var n=this.byId("idTablePopout");var s=n.getBinding("items");s.filter(i,"Application")},onSearchTerminalPop:function(e){var t=[],i=[];var a=e.getSource().getValue();if(a&&a.length>u.INTZERO){t.push(new r({filters:[new r({path:u.pathTer,operator:o.Contains,value1:a}),new r({path:u.pathTName,operator:o.Contains,value1:a})],and:false}));i.push(new r({filters:t,and:true}))}var n=this.byId("idTerTablePopout");var s=n.getBinding("items");s.filter(i,"Application")},onSearchProductPop:function(e){var t=[],i=[];var a=e.getSource().getValue();if(a&&a.length>u.INTZERO){t.push(new r({filters:[new r({path:u.pathProd,operator:o.Contains,value1:a}),new r({path:u.pathProdName,operator:o.Contains,value1:a})],and:false}));i.push(new r({filters:t,and:true}))}var n=this.byId("idProdTablePopout");var s=n.getBinding("items");s.filter(i,"Application")},onEditCustomer:function(){var e=this.getView().byId("idProductsTable"),i=[];var a=e.getSelectedContextPaths()[0],r=e.indexOfItem(e.getSelectedItem());if(r!==u.INTNEGONE){var o=this.getView().getModel("oModel").getProperty(a);var n=[],s=[];for(var d=u.INTZERO;d<o.ProductList.results.length;d++){n.push({Product:o.ProductList.results[d].Product,ProductName:o.ProductList.results[d].ProductName})}for(var d=u.INTZERO;d<o.TerminalList.results.length;d++){s.push({Terminal:o.TerminalList.results[d].Terminal,TerminalName:o.TerminalList.results[d].TerminalName})}i.push({Customer:o.Customer,CustomerName:o.CustomerName,ShipTo:o.ShipTo,ShipToName:o.ShipToName,ProductList:n,TerminalList:s,EmailTo:o.EmailTo,EmailArray:o.EmailArray,DailyJob:o.DailyJob,OnDemandJob:o.OnDemandJob});this.getView().getModel("oModel").setProperty("/selectedRow",i);var l=sap.ui.core.UIComponent.getRouterFor(this);l.navTo("RouteEditView",{Data:"1"})}else{t.error(this.oBundle.getText("selectCustomerproceed"))}},onEditCustomerPopout:function(){var e=this.getView().byId("idTablePopout"),i=[];var a=e.getSelectedContextPaths()[0],r=e.indexOfItem(e.getSelectedItem());if(r!==u.INTNEGONE){var o=this.getView().getModel("oModel").getProperty(a);var n=[],s=[];for(var d=u.INTZERO;d<o.ProductList.results.length;d++){n.push({Product:o.ProductList.results[d].Product,ProductName:o.ProductList.results[d].ProductName})}for(var d=u.INTZERO;d<o.TerminalList.results.length;d++){s.push({Terminal:o.TerminalList.results[d].Terminal,TerminalName:o.TerminalList.results[d].TerminalName})}i.push({Customer:o.Customer,CustomerName:o.CustomerName,ShipTo:o.ShipTo,ShipToName:o.ShipToName,ProductList:n,TerminalList:s,EmailTo:o.EmailTo,EmailArray:o.EmailArray,DailyJob:o.DailyJob,OnDemandJob:o.OnDemandJob});this.getView().getModel("oModel").setProperty("/selectedRow",i);var l=sap.ui.core.UIComponent.getRouterFor(this);l.navTo("RouteEditView",{Data:"1"})}else{t.error(this.oBundle.getText("selectCustomerproceed"))}},onValueProductAfterClose:function(){this.byId("addProduct").destroy()},onDeleteTerminal:function(){var e=this.getView().byId("idTableTerminal"),i=this;var a=e.indexOfItem(e.getSelectedItem());var r=this.getView().getModel("oModel").getProperty("/TerminalData");if(a!==u.INTNEGONE){var o=r[a];t.confirm(i.oBundle.getText("terminalDeleted",[o.Terminal,o.TerminalName]),{onClose:function(e){if(e===u.actionOK){n.show();i.oDataModelT.callFunction("/deleteTerminal",{method:u.httpPost,urlParameters:{terminal:o.Terminal},success:function(e){n.hide();if(e.deleteTerminal.data.message!==undefined){t.error(e.deleteTerminal.data.message)}else{s.show(i.oBundle.getText("delSucc"));i.getTerminalDetails()}},error:function(e){n.hide();var i=JSON.parse(e.responseText).error.message.value;t.error(i,{details:e})}})}}})}else{t.error(i.oBundle.getText("delCheck"))}},onDeleteProduct:function(e){var i=this.getView().byId("producttbl"),a=this;var r=i.indexOfItem(i.getSelectedItem());var o=this.getView().getModel("oModel").getProperty("/ProductData");if(r!==u.INTNEGONE){var d=o[r];t.confirm(a.oBundle.getText("productDeleted",[d.Product,d.ProductName]),{onClose:function(e){if(e===u.actionOK){n.show();a.oDataModelT.callFunction("/deleteProduct",{method:u.httpPost,urlParameters:{product:d.Product},success:function(e){n.hide();if(e.deleteProduct.data.message!==undefined){t.error(e.deleteProduct.data.message)}else{s.show(a.oBundle.getText("delSucc"));a.getProductDetails();a.getCustomerDetails()}},error:function(e){n.hide();var i=JSON.parse(e.responseText).error.message.value;t.error(i,{details:e})}})}}})}else{t.error(a.oBundle.getText("delCheck"))}},onDeleteTerminalPopout:function(){var e=this.getView().byId("idTerTablePopout"),i=this;var a=e.indexOfItem(e.getSelectedItem());var r=this.getView().getModel("oModel").getProperty("/TerminalData");if(a!==u.INTNEGONE){var o=r[a];t.confirm(i.oBundle.getText("terminalDeleted",[o.Terminal,o.TerminalName]),{onClose:function(e){if(e===u.actionOK){n.show();i.oDataModelT.callFunction("/deleteTerminal",{method:u.httpPost,urlParameters:{terminal:o.Terminal},success:function(e){n.hide();if(e.deleteTerminal.data.message!==undefined){t.error(e.deleteTerminal.data.message)}else{s.show(i.oBundle.getText("delSucc"));i.getTerminalDetails()}},error:function(e){n.hide();var i=JSON.parse(e.responseText).error.message.value;t.error(i,{details:e})}})}}})}else{t.error(i.oBundle.getText("delCheck"))}},onDeleteProductPopout:function(e){var i=this.getView().byId("idProdTablePopout"),a=this;var r=i.indexOfItem(i.getSelectedItem());var o=this.getView().getModel("oModel").getProperty("/ProductData");if(r!==u.INTNEGONE){var d=o[r];t.confirm(a.oBundle.getText("productDeleted",[d.Product,d.ProductName]),{onClose:function(e){if(e===u.actionOK){n.show();a.oDataModelT.callFunction("/deleteProduct",{method:u.httpPost,urlParameters:{product:d.Product},success:function(e){n.hide();if(e.deleteProduct.data.message!==undefined){t.error(e.deleteProduct.data.message)}else{s.show(a.oBundle.getText("delSucc"));a.getProductDetails();a.getCustomerDetails()}},error:function(e){n.hide();var i=JSON.parse(e.responseText).error.message.value;t.error(i,{details:e})}})}}})}else{t.error(a.oBundle.getText("delCheck"))}},onEmailCCSelectDialogPress:function(){var e=this.getView(),t=[],i=e.getModel("oModel").getProperty("/emailsCC");if(i){if(i[0]!=""){for(var r=u.INTZERO;r<i.length;r++){var o=new sap.m.Token({key:i[r],text:i[r]});t.push(o)}}}if(!this.byId("addEmail")){a.load({id:e.getId(),name:u.fragmentAddCCEmail,controller:this}).then(function(i){e.addDependent(i);var a=sap.ui.core.Fragment.byId(e.getId(),"multiInputemail");a.setTokens(t);var r=function(e){var t=e.text;var i=t.split("@");var r=/^\w+[\w-+\.]*\@\w+([-\.]\w+)*\.[a-zA-Z]{2,}$/;if(!r.test(t)||i[u.INTONE]!=="marathonpetroleum.com"){a.setValueState(sap.ui.core.ValueState.Error)}else{a.setValueState(sap.ui.core.ValueState.None);return new d({key:t,text:t})}};a.addValidator(r);i.open()})}else{this.byId("addEmail").open()}},onEmailChangeCC:function(e){var t=this.getView().byId(e.getSource().getId());var i=e.getParameters().value;var a=function(e){var i=e.text;var a=i.split("@");var r=/^\w+[\w-+\.]*\@\w+([-\.]\w+)*\.[a-zA-Z]{2,}$/;if(!r.test(i)){t.setValueState(sap.ui.core.ValueState.Error)}else{t.setValueState(sap.ui.core.ValueState.None);return new d({key:i,text:i})}};if(i===""){t.setValueState(sap.ui.core.ValueState.None)}t.addValidator(a)},onCCEmailClose:function(){this.byId("addEmail").close();this.byId("addEmail").destroy()},onCCEmailSave:function(){n.show();var e=this.getView().byId("multiInputemail").getTokens(),i="",a=this;if(e.length!==u.INTZERO){for(var r=u.INTZERO;r<e.length;r++){var o=e[r].getKey();if(r===u.INTZERO){i=o}else{i=i+u.spliter+o}}}var s={Key:u.emailCC,Value:i};var d=JSON.stringify(s);this.oDataModelT.callFunction("/createCCEmail",{method:u.httpPost,urlParameters:{createData:d},success:function(e){n.hide();t.success(a.oBundle.getText("savedSucc"),{onClose:function(e){if(e===t.Action.OK){a.onCCEmailClose();a.getCCEmails()}}})},error:function(e){n.hide();t.error(a.oBundle.getText("techError"),{details:e})}})},onPressEditOnDemand:function(){n.show();this.getJSStatusOnDemand()},getJSStatusOnDemand:function(){var e=this;this.oDataModelT.callFunction("/getJobDetails",{method:u.httpGet,success:function(i){n.hide();var a=JSON.parse(i.getJobDetails);if(a.sActive===true){e.getView().byId("idInfoLabel").setText("Suspended");e.getView().byId("idInfoLabel").setColorScheme(2);t.error(e.oBundle.getText("susCheck"))}else{e.getView().byId("idMultiInputCustomer").setEnabled(true);e.getView().byId("idDatePickerOnDemand").setEnabled(true);e.getView().byId("idMultiInputTerminal").setEnabled(true);e.getView().byId("idButtonSave").setVisible(true);e.getView().byId("idButtonCancel").setVisible(true);e.getView().byId("idButtonEdit").setVisible(false)}},error:function(i){n.hide();t.error(e.oBundle.getText("techError"),{details:i})}})},onPressCancelOnDemand:function(){this.getView().byId("idButtonSave").setVisible(false);this.getView().byId("idButtonCancel").setVisible(false);this.getView().byId("idButtonEdit").setVisible(true);this.getView().byId("idMultiInputCustomer").setEnabled(false);this.getView().byId("idDatePickerOnDemand").setEnabled(false);this.getView().byId("idMultiInputTerminal").setEnabled(false);this.getView().byId("idMultiInputCustomer").setValueState("None");this.getView().byId("idDatePickerOnDemand").setValueState("None");this.getView().byId("idMultiInputTerminal").setValueState("None");var e=this.getView().getModel("oModel").getProperty("/dateValue");this.getView().byId("idDatePickerOnDemand").setValue(e)},onPressSaveOnDemand:function(){var e=this.getView().byId("idDatePickerOnDemand").getValue(),i=this,a=this.getView().byId("idInfoLabel").getText(),r=this.getView().byId("idMultiInputCustomer").getTokens(),o=this.getView().byId("idMultiInputTerminal").getSelectedItems(),s=this.getView().byId("idMultiInputTerminal").getSelectedKeys(),d=this.getView().byId("idMultiInputTerminal").getValueState(),l=this.getView().byId("idMultiInputCustomer").getValueState(),c=this.getView().byId("idDatePickerOnDemand").getValueState(),g=e.length-21,h=e.slice(u.INTZERO,g),m=new Date(h);var T=new Date(m.getFullYear(),u.INTZERO,u.INTONE);var I=new Date(m.getFullYear(),u.INTSIX,u.INTONE);var p=Math.max(T.getTimezoneOffset(),I.getTimezoneOffset());if(m.getTimezoneOffset()<p){m=new Date(m.getTime()+u.INTONE*u.INTSIXTY*u.INTSIXTY*u.INTTHOUS*u.INTFIVE)}else{m=new Date(m.getTime()+u.INTONE*u.INTSIXTY*u.INTSIXTY*u.INTTHOUS*u.INTSIX)}var f=m.toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:true}),S=m.toDateString().slice(4)+u.SPACE+f;if(a!=="Suspended"){if(e!==""&&e!==u.SPACE&&e!==undefined&&r.length!==u.INTZERO&&o.length!==u.INTZERO){if(d!==u.ERROR||l!==u.ERROR||c!==u.ERROR){this.getView().byId("idMultiInputCustomer").setEnabled(false);this.getView().byId("idDatePickerOnDemand").setEnabled(false);this.getView().byId("idMultiInputTerminal").setEnabled(false);this.getView().byId("idButtonSave").setVisible(false);this.getView().byId("idButtonCancel").setVisible(false);this.getView().byId("idButtonEdit").setVisible(true);this.getView().byId("idTextOnDemandST").setText(h);this.getView().getModel("oModel").setProperty("/dateValue",h);var P=this.getPayloadJson(r,s);this.oDataModelT.callFunction("/createOnDemandSchedule",{method:u.httpGet,urlParameters:{time:S,desc:u.onDemand},success:function(e){n.hide();if(e.createOnDemandSchedule){i.updateOndemandData(P);t.success(i.oBundle.getText("succJSOD"));i.getCustomerDetails();i.getTerminalDetails()}},error:function(e){n.hide();t.error(i.oBundle.getText("techError"),{details:e})}})}}else{t.error(i.oBundle.getText("errormsgrequired"))}}else{t.error(i.oBundle.getText("susCheck"))}},getPayloadJson:function(e,t){var i=[],a=[];for(var r=u.INTZERO;r<e.length;r++){var o=e[r].getText().split("("),n=e[r].getKey().split("/");var s={Customer:n[0],ShipTo:n[1]};i.push(s)}for(var r=u.INTZERO;r<t.length;r++){var d={Terminal:t[r]};a.push(d)}var l={Customer:i,Terminal:a};return l},updateOndemandData:function(e){var i=this;var a=JSON.stringify(e);this.oDataModelT.callFunction("/updateOnDemand",{method:u.httpPost,urlParameters:{createData:a},success:function(e){n.hide()},error:function(e){n.hide();t.error(i.oBundle.getText("techError"),{details:e})}})},onPressSuspendEdit:function(){this.getView().byId("idDatePickerSuspend").setEnabled(true);this.getView().byId("idDatePicker2Suspend").setEnabled(true);this.getView().byId("idButtonSuspendSave").setVisible(true);this.getView().byId("idButtonSuspendCancel").setVisible(true);this.getView().byId("idButtonSuspendEdit").setVisible(false)},onPressSuspendClear:function(){this.getView().byId("idButtonSuspendCancel").setVisible(false);this.getView().byId("idButtonSuspendSave").setVisible(false);this.getView().byId("idButtonSuspendEdit").setVisible(true);this.getView().byId("idDatePickerSuspend").setEnabled(false);this.getView().byId("idDatePicker2Suspend").setEnabled(false);this.getView().byId("idDatePicker2Suspend").setValueState("None");this.getView().byId("idDatePicker2Suspend").setValueState("None");var e=this.getView().getModel("oModel").getProperty("/dateValueF"),t=this.getView().getModel("oModel").getProperty("/dateValueT");this.getView().byId("idDatePickerSuspend").setValue(e);this.getView().byId("idDatePicker2Suspend").setValue(t)},onPressSuspendSave:function(){var e=this.getView().byId("idDatePickerSuspend").getValue(),i=this.getView().byId("idDatePicker2Suspend").getValue(),a=this.getView().byId("idDatePickerSuspend").getValueState(),r=this.getView().byId("idDatePicker2Suspend").getValueState(),o=[],s=this,d=i.length-21,l=e.length-21,c=i.substring(0,d),g=e.substring(0,l),h=new Date(g),m=new Date(c),T=new Date(h.getFullYear(),u.INTZERO,u.INTONE),I=new Date(h.getFullYear(),u.INTSIX,u.INTONE),p=new Date(m.getFullYear(),u.INTZERO,u.INTONE),f=new Date(m.getFullYear(),u.INTSIX,u.INTONE);var S=Math.max(T.getTimezoneOffset(),I.getTimezoneOffset());var P=Math.max(p.getTimezoneOffset(),f.getTimezoneOffset());if(h.getTimezoneOffset()<S){h=new Date(h.getTime()+u.INTONE*u.INTSIXTY*u.INTSIXTY*u.INTTHOUS*u.INTFIVE)}else{h=new Date(h.getTime()+u.INTONE*u.INTSIXTY*u.INTSIXTY*u.INTTHOUS*u.INTSIX)}if(m.getTimezoneOffset()<P){m=new Date(m.getTime()+u.INTONE*u.INTSIXTY*u.INTSIXTY*u.INTTHOUS*u.INTFIVE)}else{m=new Date(m.getTime()+u.INTONE*u.INTSIXTY*u.INTSIXTY*u.INTTHOUS*u.INTSIX)}var V=m.toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:true}),b=m.toDateString().slice(4)+u.SPACE+V,w=h.toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:true}),D=h.toDateString().slice(4)+u.SPACE+w;if(i!==""&&i!==u.SPACE&&i!==undefined&&(e!==""&&e!==u.SPACE&&e!==undefined)){if(a!==u.ERROR||r!==u.ERROR){this.getView().byId("idDatePickerSuspend").setEnabled(false);this.getView().byId("idDatePicker2Suspend").setEnabled(false);this.getView().byId("idButtonSuspendSave").setVisible(false);this.getView().byId("idButtonSuspendEdit").setVisible(true);this.getView().byId("idButtonSuspendCancel").setVisible(false);this.getView().byId("idObjStatusS1").setText(g);this.getView().byId("idObjStatusS2").setText(c);this.getView().getModel("oModel").setProperty("/dateValueF",g);this.getView().getModel("oModel").setProperty("/dateValueT",c);o.push({time:D,Desc:"SUSPENDFROM"});o.push({time:b,Desc:"SUSPENDTO"});var N=JSON.stringify(o);this.oDataModelT.callFunction("/createSuspendSchedule",{method:u.httpGet,urlParameters:{time:N,desc:u.suspend},success:function(e){n.hide();t.success(s.oBundle.getText("succJSSus"))},error:function(e){n.hide();t.error(s.oBundle.getText("techError"),{details:e})}})}}else{n.hide();t.error(s.oBundle.getText("errormsgrequired"))}},onhandleChangeDP1Suspend:function(){var e=this.getView().byId("idDatePickerSuspend").getDateValue(),t=this.getView().byId("idDatePicker2Suspend").getDateValue();if(t<=e){this.getView().byId("idDatePicker2Suspend").setValueState("Error")}else{this.getView().byId("idDatePicker2Suspend").setValueState("None")}},onhandleChangeDP2Suspend:function(){var e=this.getView().byId("idDatePickerSuspend").getDateValue(),t=this.getView().byId("idDatePicker2Suspend").getDateValue();if(t<=e){this.getView().byId("idDatePicker2Suspend").setValueState("Error")}else if(e===null){this.getView().byId("idDatePicker2Suspend").setValueState("Error")}else{this.getView().byId("idDatePicker2Suspend").setValueState("None")}},onhandleDateCheck:function(e){var i=e.getSource(),a=e.getParameter("value"),r=e.getParameter("valid");var o=new Date(a);var n=new Date,s=n.toLocaleString("en-US",{timeZone:"America/Mexico_City"});s=new Date(s);if(r){i.setValueState("None")}else if(o<s){i.setValueState("Error");t.error(this.oBundle.getText("dateError"))}},onHandleValueHelpTerminal:function(){var e=this.getView();if(!this.byId("idDialogTerminalF4")){a.load({id:e.getId(),name:u.fragmentTerF4,controller:this}).then(function(t){e.addDependent(t);t.open()})}else{this.byId("idDialogTerminalF4").open()}},_handleValueHelpClose:function(){this.byId("idDialogTerminalF4").close();this.byId("idDialogTerminalF4").destroy()},_handleValueHelpOKTerminal:function(e){var t=e.getSource().getBinding("items");t.filter([]);var i=e.getParameter("selectedContexts");if(i&&i.length){this.getView().byId("idInputTerminalID").setValue(i.map(function(e){return e.getObject().Terminal}));this.getView().byId("idInputTerminalName").setValue(i.map(function(e){return e.getObject().Terminalname}))}},onPressTerminalSave:function(){var e=this.getView().byId("idInputTerminalID").getValue(),i=this.getView().byId("idInputTerminalName").getValue(),a,r=this.getView().byId("idInputTerminalID").getEnabled(),o=this.getView().byId("idCheckBoxDaily").getSelected(),s=this.getView().byId("idCheckBoxOnDemand").getSelected(),d=this;if(e!==""&&i!==""){n.show();a={Terminal:e,TerminalName:i,DailyJob:o,OnDemandJob:s};var l=JSON.stringify(a);if(r===true){this.oDataModelT.callFunction("/createTerminal",{method:u.httpPost,urlParameters:{createData:l},success:function(e){n.hide();if(e.createTerminal.data.status!==undefined&&e.createTerminal.data.status!==200){t.error(e.createTerminal.data.message)}else{t.success(d.oBundle.getText("terminalCreated",[e.createTerminal.data.Terminal]),{onClose:function(e){if(e===t.Action.OK){d.onTerminalClose();d.getTerminalDetails()}}})}},error:function(e){n.hide();var i=e.message;t.error(i,{details:e})}})}else{var d=this;this.oDataModelT.callFunction("/updateTerminal",{method:u.httpPost,urlParameters:{createData:l,terminal:e},success:function(e){n.hide();if(e.updateTerminal.data.status!==undefined&&e.updateTerminal.data.status!==200){t.error(e.updateTerminal.data.message)}else{t.success(d.oBundle.getText("savedSucc"));d.onTerminalClose();d.getTerminalDetails()}},error:function(e){n.hide();var i=e.message;t.error(i,{details:e})}})}}else{t.error(d.oBundle.getText("errormsgrequired"))}},onHandleValueHelpProduct:function(){var e=this.getView();this._oValueHelpDialogListProd=sap.ui.xmlfragment(u.fragmentProdF4,this);e.addDependent(this._oValueHelpDialogListProd);this._oValueHelpDialogListProd.open()},_handleValueHelpCloseProduct:function(){this._oValueHelpDialogListProd.close()},_handleValueHelpOKProduct:function(e){var t=e.getSource().getBinding("items");t.filter([]);var i=e.getParameter("selectedContexts");if(i&&i.length){this.getView().byId("idInputProductID").setValue(i.map(function(e){return e.getObject().Product}));this.getView().byId("idInputProductName").setValue(i.map(function(e){return e.getObject().ProductName}))}},onPressProductSave:function(){var e=this.getView().byId("idInputProductID").getValue(),i=this.getView().byId("idInputProductName").getValue(),a,r,o=this.getView().byId("idInputProductID").getEnabled();var s=this;if(e!==""&&i!==""){n.show();r={Product:e,ProductName:i};var a=JSON.stringify(r);if(o===true){this.oDataModelT.callFunction("/createProduct",{method:u.httpPost,urlParameters:{createData:a},success:function(e){n.hide();if(e.createProduct.data.status!==undefined&&e.createProduct.data.status!==200){t.error(e.createProduct.data.message)}else{t.success(s.oBundle.getText("productCreated",[e.createProduct.data.Product]),{onClose:function(e){if(e===t.Action.OK){s.onProductClose();s.getProductDetails()}}})}},error:function(e){n.hide();var i=e.message;t.error(i,{details:e})}})}else{this.oDataModelT.callFunction("/updateProduct",{method:u.httpPost,urlParameters:{createData:a,product:e},success:function(e){n.hide();if(e.updateProduct.data.status!==undefined&&e.updateProduct.data.status!==200){t.error(e.updateProduct.data.message)}else{t.success(s.oBundle.getText("savedSucc"));s.onProductClose();s.getProductDetails()}},error:function(e){n.hide();var i=e.message;t.error(i,{details:e})}})}}else{t.error(s.oBundle.getText("errormsgrequired"))}},onFilterBarSearch:function(e){var t=this._oBasicSearchField.getValue(),i=e.getParameter("selectionSet");var a=i.reduce(function(e,t){if(t.getValue()){switch(t.getName()){case u.filterCUSID:e.push(new r({path:u.pathCus,operator:o.Contains,value1:t.getValue()}));break;case u.filterSH:e.push(new r({path:u.pathSH,operator:o.Contains,value1:t.getValue()}));break;case u.filterName:e.push(new r({path:u.pathCName,operator:o.Contains,value1:t.getValue()}));break}}return e},[]);a.push(new r({filters:[new r({path:u.pathCus,operator:o.Contains,value1:t}),new r({path:u.pathCName,operator:o.Contains,value1:t}),new r({path:u.pathSH,operator:o.Contains,value1:t}),new r({path:u.pathSHName,operator:o.Contains,value1:t})],and:false}));this._filterTable(new r({filters:a,and:true}))},_filterTable:function(e){var t=this._oValueHelpDialogCust;t.getTableAsync().then(function(i){if(i.bindRows){i.getBinding("rows").filter(e)}if(i.bindItems){i.getBinding("items").filter(e)}t.update()})},_handleValueHelpSearchTerminal:function(e){var t=e.getParameter("value"),i=[],a=[];if(t&&t.length>u.INTZERO){i.push(new r({filters:[new r({path:u.pathTer,operator:o.Contains,value1:t}),new r({path:u.pathTername,operator:o.Contains,value1:t})],and:false}));a.push(new r({filters:i,and:true}))}var n=e.getSource().getBinding("items");n.filter([a])},_handleValueHelpSearchProduct:function(e){var t=e.getParameter("value"),i=[],a=[];if(t&&t.length>u.INTZERO){i.push(new r({filters:[new r({path:u.pathProd,operator:o.Contains,value1:t}),new r({path:u.pathProdName,operator:o.Contains,value1:t})],and:false}));a.push(new r({filters:i,and:true}))}var n=e.getSource().getBinding("items");n.filter([a])},getGroup:function(e){var t=e.getProperty("Customer"),i=t+" "+e.getProperty("CustomerName");return{key:i,title:e.getProperty("CountShipTo").trim()}},getGroupHeader:function(e){var t=this.oBundle.getText("TABLE_GROUP_HEADER");return new sap.m.GroupHeaderListItem({title:e.key,count:e.title})}})});